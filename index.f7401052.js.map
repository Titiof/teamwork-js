{"mappings":"gfAAAA,EAAA,S,sBAAA,IAEMC,EAAQC,SAASC,cAAc,gBAC/BC,EAAcH,EAAME,cAAc,UAClCE,EAAkBJ,EAAME,cAAc,eACtCG,EAAuBL,EAAME,cAAc,kBAG3CI,GAFWN,EAAME,cAAc,oBAEnB,IACdK,EAAa,GAiEjB,SAASC,EAAuBC,GAC9B,GAAyB,WAArBA,EAAEC,OAAOC,QAAsB,CACjC,IAAMC,EAAeL,EAAWM,IAC1BC,EAAcR,EAAUS,WAAU,SAACC,G,OAASA,EAAKH,MAAQD,C,KAC3C,IAAhBE,IACFR,EAAUW,OAAOH,EAAa,GAC9BI,aAAaC,QAAQ,gBAAiBC,KAAKC,UAAUf,IACrDD,EAAqBiB,UAAUC,IAAI,aACnCnB,EAAgBkB,UAAUE,OAAO,a,EAKvCpB,EAAgBqB,iBAAiB,SAzBjC,SAA2BhB,GACA,WAArBA,EAAEC,OAAOC,SACPJ,IACFD,EAAUoB,KAAKnB,GACfW,aAAaC,QAAQ,gBAAiBC,KAAKC,UAAUf,IACrDF,EAAgBkB,UAAUC,IAAI,aAC9BlB,EAAqBiB,UAAUE,OAAO,aACtCnB,EAAqBoB,iBAAiB,QAASjB,G,IAmBrDH,EAAqBoB,iBAAiB,QAASjB,GAE/CL,EAAYsB,iBAAiB,SAAS,WACpCzB,EAAMsB,UAAUC,IAAI,Y,IAGtBI,OAAOF,iBAAiB,WAAW,SAAUhB,GAC7B,WAAVA,EAAEmB,KACJ5B,EAAMsB,UAAUC,IAAI,Y,IAINtB,SAAS4B,iBAAiB,cAElCC,SAAQ,SAACC,GACjBA,EAASN,iBAAiB,SAAS,SAAUhB,GAC3CA,EAAEuB,iBACF,IAAMC,EAAMF,EAASG,aAAa,QAClCP,OAAOQ,KAAKF,EAAK,S","sources":["src/js/modal.js"],"sourcesContent":["import { BooksAPI } from './books-api';\n\nconst modal = document.querySelector('[data-modal]');\nconst closeButton = modal.querySelector('.close');\nconst addToListButton = modal.querySelector('.add-button');\nconst removeFromListButton = modal.querySelector('.remove-button');\nconst bookCard = modal.querySelector('.modal-book-card');\n\nconst bookArray = [];\nlet bookObject = {};\n\nasync function openModal(bookId) {\n  try {\n    const booksAPI = new BooksAPI();\n    const data = await booksAPI.getBookById(bookId);\n    addMarkup(data);\n    makeBookObjects(data);\n    modal.classList.remove('is-hidden');\n  } catch (error) {\n    console.error(error.message);\n  }\n}\n\nfunction addMarkup(data) {\n  const markup = createMarkup(data);\n  bookCard.innerHTML = markup;\n}\n\nfunction createMarkup(data) {\n  const { _id, book_image, title, author, description, buy_links } = data;\n  return `<div class=\"book-id\">\n    <img class=\"modal-cover\" src=\"${book_image}\" alt=\"Обкладинка книги\">\n    <div class=\"book-info\">\n        <div class=\"heading\">\n            <h1 class=\"modal-title\">${title}</h1>\n            <h3 class=\"modal-author\">${author}</h3>\n        </div>\n        <p class=\"modal-description\">${description}</p>\n        <ul class=\"book-shops\">\n            <li class=\"shop\"><a href=\"${buy_links[0].url}\" class=\"shop-link\" target=\"_blank\">\n            <img\n            class=\"shops-item-icon\"\n             src=\"./images/modal/amazon.webp\"\n            alt=\"Amazone-logo\" \n              />\n              </a></li>\n            <li class=\"shop\"><a href=\"${buy_links[1].url}\" class=\"shop-link\" target=\"_blank\">\n            <img\n            class=\"shops-item-icon\"\n            src=\"./images/modal/amazon-book.webp\"\n            alt=\"Apple-Books-logo\" \n              /></a></li>\n        </ul>\n    </div>\n</div>`;\n}\n\nfunction makeBookObjects(data) {\n  const { _id, book_image, title, author, buy_links, description } = data;\n  bookObject = { _id, book_image, title, author, buy_links, description };\n}\n\nfunction addToShoppingList(e) {\n  if (e.target.tagName === 'BUTTON') {\n    if (bookObject) {\n      bookArray.push(bookObject);\n      localStorage.setItem('shopping-list', JSON.stringify(bookArray));\n      addToListButton.classList.add('is-hidden');\n      removeFromListButton.classList.remove('is-hidden');\n      removeFromListButton.addEventListener('click', removeFromShoppingList);\n    }\n  }\n}\n\nfunction removeFromShoppingList(e) {\n  if (e.target.tagName === 'BUTTON') {\n    const removeBookId = bookObject._id;\n    const removeIndex = bookArray.findIndex((item) => item._id === removeBookId);\n    if (removeIndex !== -1) {\n      bookArray.splice(removeIndex, 1);\n      localStorage.setItem('shopping-list', JSON.stringify(bookArray));\n      removeFromListButton.classList.add('is-hidden');\n      addToListButton.classList.remove('is-hidden');\n    }\n  }\n}\n\naddToListButton.addEventListener('click', addToShoppingList);\nremoveFromListButton.addEventListener('click', removeFromShoppingList);\n\ncloseButton.addEventListener('click', function () {\n  modal.classList.add('is-hidden');\n});\n\nwindow.addEventListener('keydown', function (e) {\n  if (e.key === 'Escape') {\n    modal.classList.add('is-hidden');\n  }\n});\n\nconst shopLinks = document.querySelectorAll('.shop-link');\n\nshopLinks.forEach((shopLink) => {\n  shopLink.addEventListener('click', function (e) {\n    e.preventDefault();\n    const url = shopLink.getAttribute('href');\n    window.open(url, '_blank');\n  });\n});"],"names":["parcelRequire","$40873ecf3c18e122$var$modal","document","querySelector","$40873ecf3c18e122$var$closeButton","$40873ecf3c18e122$var$addToListButton","$40873ecf3c18e122$var$removeFromListButton","$40873ecf3c18e122$var$bookArray","$40873ecf3c18e122$var$bookObject","$40873ecf3c18e122$var$removeFromShoppingList","e","target","tagName","removeBookId","_id","removeIndex","findIndex","item","splice","localStorage","setItem","JSON","stringify","classList","add","remove","addEventListener","push","window","key","querySelectorAll","forEach","shopLink","preventDefault","url","getAttribute","open"],"version":3,"file":"index.f7401052.js.map"}